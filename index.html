<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Node.JS - JavaScript со вкусом сервера</title>

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/default.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>
		<!-- <style>
			img { zoom: 2; position: relative; top: -50px;}
		</style> -->
		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h2>@floatdrop</h2>
				</section>
				<section data-background="img/bezishodnost-bg.jpeg">
					<img src="img/kot-bezishod.jpg" style="zoom: 2"/>
				</section>
				<section data-background="img/sea.png">
					<div class="fragment" style="padding: 100px 50px; background: radial-gradient(ellipse at center, rgba(0,0,0,0.1) 10%, rgba(0,0,0,0) 50%)">
						<h1>Node.JS</h1>
					</div>
				</section>
				<section>
					<section data-background="img/crockford-on-javascript.jpg">
						<h1>History</h1>
                        <h3 style="padding-top: 50px;"><a href="http://bit.ly/crcfd">bit.ly/crcfd</a></h3>
					</section>
					<section data-background="img/applebg.jpeg" data-background-size="200px" data-background-repeat="repeat">
						<img src="img/hypercard_montage2.jpg"/>
						<br/><br/>
						<h3>1987</h3>
					</section>
					<section data-background="img/applebg.jpeg" data-background-size="200px" data-background-repeat="repeat">
						<pre><code>
on mouseUp
	get the selection
	if it is empty then as "Dial what number?"
	if it is not empty then
		push this card
		visual effect zoom open
		go to stack "Phone"
		dial it
		pop card
	end if
end mouseUp
						</code></pre><br/>
						<h3>1987</h3>
					</section>
					<section data-background="img/lucas.png">
						<div class="fragment" style="color: #000; padding: 100px 0px; background: radial-gradient(ellipse at center, rgba(255,255,255,1) 20%, rgba(255,255,255,0) 80%)">
							<p>Был написан за <span class="fragment" style="font-size: 48pt">10</span> дней</p>
							<p class="fragment">Function as first-class objects</p>
							<p class="fragment">Расчитан на однопоточность</p>
						</div>
						<h2 style="color: #000; position: relative; top: 100px;">1995</h2>
					</section>
					<section data-background="img/Sandro_Botticelli_-_La_nascita_di_Venere_-_Google_Art_Project_-_edited.jpg">
						<img class="fragment" width="300px" src="img/logo-jquery.png"/>
						<h2 class="fragment" style="margin: 50px;">AJAX</h2>
						<h2 style="position: relative; top: 100px;">2005</h2>
					</section>
					<section data-background="img/Johann_Peter_Krafft_005.jpg">
						<div class="fragment" style="padding: 100px 50px; background: radial-gradient(ellipse at center, rgba(0,0,0,0.5) 30%, rgba(0,0,0,0) 60%)">
							<h1>Node.JS</h1>
							<h2>JavaScript on server</h2>
						</div>
						<h2 style="position: relative; top: 100px;">2009</h2>
						<aside class="notes">
The term Ajax was coined on 18 February 2005 by Jesse James Garrett in an article entitled "Ajax: A New Approach to Web Applications", based on techniques used on Google pages.[1]
On 5 April 2006, the World Wide Web Consortium (W3C) released the first draft specification for the XMLHttpRequest object in an attempt to create an official web standard.[6]
						</aside>
					</section>
				</section>
				<section>
					<section>
						<h2>Apache + PHP = &#x2764;</h2>
						<div class="fragment">
							<div class="curved-hz">
								<img style="" src="img/wpid-overalld1.png" width="100%"/>
							</div>
						</div>
					</section>
					<section>
						<h2>index.php</h2>
						<pre><code style="font-size: 22pt; line-height: 22pt;">$result = mysqli_query( $con,
	"SELECT * FROM Persons");

while($row = mysqli_fetch_array($result)) {
  echo $row['Name']."\n";
}

file_put_contents("access.log", 
	"Request done")</code></pre>
					</section>
					<section>
						<h2>Single-thread server</h2>
						<div class="anim_request_1">
						<div class="anim_request_2 fragment">
						<div class="anim_request_3 fragment">
						<div class="anim_request_4 fragment">
						<div class="anim_request_5 fragment">
						</div>
						</div>
						</div>
						</div>
						</div>
						<br/><br/>
						<a href="http://kunkle.org/nodejs-explained-pres/">Pictures from node-explained</a>
					</section>
					<section>
						<img src="img/latency-bar-graph.png" width="100%"/>
					</section>
					<section>
						<div class="curved-hz">
							<img src="img/2.2-new-features.png" />
						</div>
					</section>
					<section>
						<h2>Multi-thread server</h2>
						<img src="img/scaling-threads.png"/>
                    </section>
					<section>
						<img src="img/aWZjWe4_460sa.gif" width="100%"/>
					</section>
					<section data-background="img/ryan_dahl.png">
                        <h1 class="fragment">Ryan Dahl</h1>
                        <p>&nbsp;</p>
                        <blockquote class="fragment" style="background: rgba(0,0,0,.5); padding: 15px;">I/O has to be done differently.<br/>We are doing it wrong</blockquote>
                        <p>&nbsp;</p>
                        <h3 class="fragment"><a href="http://bit.ly/jsconf-node">bit.ly/jsconf-node</a></h3>
                    </section>
                    <section style="overflow: visible;">
                    	<h2>event-loop сервер</h2>
						<div class="reactor-request frame-1">
						<div class="reactor-request frame-2 fragment">
						<div class="reactor-request frame-3 fragment">
						<div class="reactor-request frame-4 fragment">
						<div class="reactor-request frame-5 fragment">
						<div class="reactor-request frame-6 fragment">
						<div class="reactor-request frame-7 fragment">
						</div>
						</div>
						</div>
						</div>
						</div>
						</div>
						</div>
                    </section>
                    <section>
						<h2>event-loop server</h2>
						<img src="img/scaling-event-loop.png"/>
                    </section>
                    <section>
						<img src="img/v-jope-post.png" class="console"/>
						<a href="http://bit.ly/bombanulo">bit.ly/bombanulo</a>
                    </section>
                    <section>
						<h2>event-loop server</h2>
						<h3>goes wrong</h3>
						<img src="img/scaling-event-loop-goes-wrong.png"/>
                    </section>
                    <section>
                    	<h2>JavaScript is slow</h2>
						<img src="img/stupid.png" class="console"/>
						<a href="http://bit.ly/bombanulo-2">bit.ly/bombanulo-2</a>
                    </section>
                    <section>
						<h2>"Simple" benchmark</h2>
						<br/>
						<div style="width:700px; margin: auto;" class="curved-hz"><img src="img/simple-benchmark.png"/></div>
						<br/>
						<a href="http://bit.ly/dumb-test">bit.ly/dumb-test</a>
                    </section>
                    <!--
                    <section>
                    	<img src="img/timeline-no-task-1.png"/>
                    	<br/><br/>
                    	<a href="http://bit.ly/lxjs2013-node">bit.ly/lxjs2013-node</a>
                    </section>
                    -->
				</section>
				<section>
					<section>
						<h1>Installing</h1>
						<img src="img/install.png"/>
						<a href="http://nodejs.org/download/">nodejs.org/download</a>
					</section>
					<section data-transition="none">
						<h2>Running</h2>
						<img src="img/console.png" class="console"/>
					</section>
					<section data-transition="none">
						<h2>Running</h2>
						<img src="img/console-1.png" class="console"/>
					</section>
					<section data-transition="none">
						<h2>Running</h2>
						<img src="img/console-2.png" class="console"/>
					</section>
					<section data-transition="none">
						<h2>Running</h2>
						<img src="img/console-3.png" class="console"/>
					</section>
					<section data-transition="none">
						<h2>Running</h2>
						<img src="img/console-4.png" class="console"/>
					</section>
					<section data-transition="none">
						<h2>Running</h2>
						<img src="img/console-5.png" class="console"/>
					</section>

					<section data-transition="none">
						<h2>windows</h2>
						<img src="img/console-6.png" class="console"/>
					</section>
					
					<section data-transition="none">
						<h2>window</h2>
						<img src="img/console-7.png" class="console"/>
					</section>

					<section data-transition="none">
						<h2>document</h2>
						<img src="img/console-8.png" class="console"/>
					</section>

					<section data-transition="none">
						<h2>document</h2>
						<img src="img/console-9.png" class="console"/>
					</section>

					<section data-transition="none">
						<h2>global</h2>
						<img src="img/console-global-1.png" class="console"/>
					</section>

					<section data-transition="none">
						<h2>global</h2>
						<img src="img/console-global-2.png" class="console"/>
					</section>

					<section data-transition="none">
						<h2>global</h2>
						<img src="img/console-global-3.png" class="console"/>
					</section>

					<section data-transition="none">
						<h2>process</h2>
						<img src="img/console-process-1.png" class="console"/>
					</section>

					<section data-transition="none">
						<h2>process</h2>
						<img src="img/console-process-2.png" class="console"/>
					</section>
				</section>
				
				<section>
					<section>
						<h1>Modules</h1>
						<br/>
						<h3>require(<span style="color: yellow">'antigravity'</span>)</h3>
					</section>
					
					<section>
						<h1>module.js</h1>
						<br/>
						<pre><code style="font-size: 30pt; line-height: 32pt;">function HelloWorld () {
  console.log('Hello world');
}

console.log('Module loaded');</code></pre>
					</section>

					<section>
						<h1>index.js</h1>
						<br/>
						<pre><code style="font-size: 32pt; line-height: 32pt;">require('./module');</code></pre>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-1.png"/>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-2.png"/>
					</section>

					<section>
						<h1>index.js</h1>
						<br/>
						<pre><code style="font-size: 32pt; line-height: 32pt;">require('./module');

HelloWorld();</code></pre>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-1.png"/>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-3.png"/>
					</section>

					<section>
						<h1>module.js</h1>
						<br/>
						<pre><code style="font-size: 24pt; line-height: 32pt;">function HelloWorld () {
  console.log('Hello world');
}

console.log('Module loaded');

exports.HelloWorld = HelloWorld;</code></pre>
					</section>

					<section>
						<h1>index.js</h1>
						<br/>
						<pre><code style="font-size: 24pt; line-height: 32pt;">var module = require('./module');

module.HelloWorld();</code></pre>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-1.png"/>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-4.png"/>
					</section>

					<section>
						<h1>module.js</h1>
						<br/>
						<pre><code style="font-size: 24pt; line-height: 32pt;">function HelloWorld () {
  console.log('Hello world');
}

console.log('Module loaded');

global.HelloWorld = HelloWorld;</code></pre>
					</section>

					<section>
						<h1>index.js</h1>
						<br/>
						<pre><code style="font-size: 24pt; line-height: 32pt;">require('./module');

HelloWorld();</code></pre>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-1.png"/>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-4.png"/>
					</section>

					<section>
						<h2><span style="color: yellow">exports</span> vs <span style="color: yellow">module.exports</span></h2><br/>
						<div class="fragment">
						<h3>russian.js</h3>
						<pre><code class="javascript" style="font-size: 24pt; line-height: 32pt;">var en_translation = {
  yes: 'Да',
  no: 'Нет' 
};

exports = en_translation;</code></pre>
						</div>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-5.png"/>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-6.png"/>
					</section>

					<section>
						<h2><span style="color: yellow">exports</span> vs <span style="color: yellow">module.exports</span></h2><br/>
						<h3>russian.js</h3>
						<pre><code class="javascript" style="font-size: 24pt; line-height: 32pt;">var en_translation = {
  yes: 'Да',
  no: 'Нет' 
};

module.exports = en_translation;</code></pre>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-7.png"/>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-8.png"/>
					</section>

					<section>
						<h2><span style="color: yellow">exports</span> vs <span style="color: yellow">module.exports</span></h2><br/>
						<h3>russian.json</h3>
						<pre><code class="json" style="font-size: 24pt; line-height: 32pt;">{
	"yes": "да",
	"no": "нет"
}</code></pre>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-9.png"/>
					</section>

					<section data-transition="none">
						<img class="console" src="img/console-module-1-10.png"/>
					</section>
					
					<section data-transition="none">
						<img class="console" src="img/console-module-1-11.png"/>
					</section>

					<section>
						<h2>requrie(<span style='color: yellow'>'./directory'</span>)</h2>
						<br/>
						<ol reversed>
							<li class="fragment">require(<span style='color: yellow'>'./directory/index.json'</span>)</li>
							<li class="fragment">require(<span style='color: yellow'>'./directory/index.js'</span>)</li>
							<li class="fragment">require(<span style='color: yellow'>'./directory/'</span> + require(<span style='color: yellow'>'./directory/package.json'</span>).main);</li>
						</ol>
					</section>

					<section>
						<pre class="no-lines fragment grow"><code class="javascript">require('http')</code></pre>
						<pre class="no-lines fragment grow"><code class="javascript">require('express')</code></pre>
						<pre class="no-lines"><code class="javascript">require('./index.js')</code></pre>
						<pre class="no-lines"><code class="javascript">require('./config.json')</code></pre>
						<pre class="no-lines"><code class="javascript">require('./module') // Directory</code></pre>
					</section>

					<section>
						<h2>Simple web-server</h2>
						<img src="img/tony-stark.jpg" class="fragment" width="50%"/>
					</section>

					<section data-transition="none">
						<h2>Simple web-server</h2>
						<br/>
						<img class="console" src="img/console-server-1.png"/>
					</section>

					<section data-transition="none">
						<h2>Simple web-server</h2>
						<br/>
						<img class="console" src="img/console-server-2.png"/>
					</section>

					<section data-transition="none">
						<h2>Simple web-server</h2>
						<br/>
						<img class="console" src="img/console-server-3.png"/>
					</section>

					<section>
						<h2>Simple web-server</h2>
						<br/>
						<h3>index.js</h3>
						<pre><code style="font-size: 20pt; line-height: 24pt;" class="javascript">var http = require('http');

function helloService(request, response) {
	response.end("Hello, stranger!");
}

var server = http.createServer(helloService);

module.exports = server;</code></pre>
					</section>

					<section data-transition="none">
						<h2>Run, Forest, Run!</h2>
						<br/>
						<img src="img/console-server-4.png" class="console">
					</section>

					<section data-transition="none">
						<h2>Run, Forest, Run!</h2>
						<br/>
						<img src="img/console-server-5.png" class="console">
					</section>

					<section data-transition="none">
						<h2>Run, Forest, Run!</h2>
						<br/>
						<img src="img/console-server-6.png" class="console">
					</section>

					<section data-transition="none">
						<h2>Run, Forest, Run!</h2>
						<br/>
						<img src="img/console-server-7.png" class="console">
					</section>

					<section>
						<h2>Simple web-server</h2>
						<br/>
						<h3>node_modules</h3>
					</section>

					<section data-transition="none">
						<h2>Run, Forest, Run!</h2>
						<br/>
						<img src="img/console-server-7.png" class="console">
					</section>

					<section data-transition="none">
						<h2>Run, Forest, Run!</h2>
						<br/>
						<img src="img/console-server-8.png" class="console">
					</section>

					<section data-transition="none">
						<h2>Run, Forest, Run!</h2>
						<br/>
						<img src="img/console-server-9.png" class="console">
					</section>

					<section data-transition="none">
						<h2>Run, Forest, Run!</h2>
						<br/>
						<img src="img/console-server-10.png" class="console">
					</section>

					<section>
						<h2>Look up</h2>
						<a href="http://nodejs.org/api/modules.html">nodejs.org/api/modules.html</a>
						<br/>
						<img src="img/node-modules-docs.png"/>
					</section>

					<section>
						<h2>Look up</h2>
						<br/>
						<img src="img/node-modules-docs-2.png"/>
					</section>

					<section>
						<h2>require(<span style="color: yellow">"antigravity"</span>)</h2>
						<h4>in <span style="color: yellow">/home/user/programm/library/index.js</span></h4>
						<br/>
						<ol>
							<li class="fragment">/home/user/programm/library/<span style="color: #00FF00">node_modules</span>/<span style="color: yellow">antigravity</span></li>
							<li class="fragment">/home/user/programm/<span style="color: #00FF00">node_modules</span>/<span style="color: yellow">antigravity</span></li>
							<li class="fragment">/home/user/<span style="color: #00FF00">node_modules</span>/<span style="color: yellow">antigravity</span></li>
							<li class="fragment">/home/<span style="color: #00FF00">node_modules</span>/<span style="color: yellow">antigravity</span></li>
							<li class="fragment">/<span style="color: #00FF00">node_modules</span>/<span style="color: yellow">antigravity</span></li>
						</ol>
						<br/><br/>
						<p class="fragment">NODE_PATH</p>
						<br/>
						<p class="fragment" style="font-size: 18pt;">$HOME/.node_modules, $HOME/.node_libraries, $PREFIX/lib/node</p>
					</section>

					<section>
						<h2>node_modules/antigravity.js</h2>
						<pre><code>module.exports = new Date();</code></pre>
						<br/><br/>
						<h2>index.js</h2>
						<pre><code>console.log(require("antigravity"));</code></pre>
					</section>

					<section data-transition="none">
						<img src="img/console-require-2.png" class="console">
					</section>

					<section data-transition="none">
						<img src="img/console-require-3.png" class="console">
					</section>

					<section data-transition="none">
						<img src="img/console-require-4.png" class="console">
					</section>

					<section data-transition="none">
						<img src="img/console-require-5.png" class="console">
					</section>

					<section data-transition="none">
						<img src="img/console-require-6.png" class="console">
					</section>

					<section data-transition="none">
						<img src="img/console-require-7.png" class="console">
					</section>

					<section data-transition="none">
						<img src="img/console-require-8.png" class="console">
					</section>

					<section data-transition="none">
						<h2>node_modules/antigravity.js</h2>
						<pre><code>console.log(module);

module.exports = new Date();</code></pre>
					</section>

					<section>
						<img src="img/console-require-module.png" class="console">
					</section>

					<section>
						<img src="img/console-require-module-1.png" class="console">
					</section>

					<section>
						<h2>Circular dependencies</h2>
						<br/>
						<img src="img/circular-dependencies.png" width="100%"/>
					</section>

					<section>
						<h2>Circular dependencies</h2>
						<br/>
						<h3>a.js</h3>
						<pre><code>var b = require('./b.js');
console.log("B: ", b);</code></pre>
						<br/>
						<h3>b.js</h3>
						<pre><code>var a = require('./a.js');
console.log("A: ", a);</code></pre>
					</section>

					<section data-transition="none">
						<img src="img/node-modules-circ-1.png" class="console">
					</section>

					<section data-transition="none">
						<img src="img/node-modules-circ-2.png" class="console">
					</section>

					<section data-transition="none">
						<img src="img/node-modules-circ-3.png" class="console">
					</section>

					<section data-transition="none">
						<img src="img/node-modules-circ-4.png" class="console">
					</section>

					<section data-transition="none">
						<img src="img/node-modules-circ-5.png" class="console">
					</section>

					<section>
						<h2>Circular dependencies</h2>
						<br/>
						<h3>a.js</h3>
						<pre><code>module.exports.hello = "Hello from A";
var b = require('./b.js');
module.exports.helloFromB = b.hello;
console.log("B: ", b);</code></pre>
						<br/>
						<h3>b.js</h3>
						<pre><code>module.exports.hello = "Hello from B";
var a = require('./a.js');
module.exports.helloFromA = a.hello;
console.log("A: ", a);</code></pre>
					</section>

					<section data-transition="none">
						<img src="img/node-modules-circ-6.png" class="console">
					</section>

					<section data-transition="none">
						<img src="img/node-modules-circ-7.png" class="console">
					</section>
					
					<section>
						<pre><code style="font-size: 22pt; line-height: 32pt;">var module = require('http');

module.globalAgent = {};

console.log(require('http').globalAgent);</code></pre>
					</section>

					<section data-transition="none">
						<h2>Unfinished copy</h2>
						<img src="img/node-modules-circ-8.png" class="console">
					</section>

					<section data-transition="none">
						<h2>Unfinished copy</h2>
						<img src="img/node-modules-circ-9.png" class="console">
					</section>
				</section>

				<section>
					<section>
                        <img src="img/npm.png" />
                    </section>
                    <section>
                    	<div class="curved-hz">
                        	<img src="img/modulecounts.png" height="372" width="597" style="padding: 20px;"/>
                        </div>
                        <br/>
                        <a href="http://www.modulecounts.com/">modulecounts.com</a>
                    </section>
                    <section>
						<img src="img/console-npm-1.png" class="console">
                    </section>
                    <section data-transition="none">
                    	<h2>Installing module</h2>
						<img src="img/console-npm-2-1.png" class="console">
                    </section>
                    <section data-transition="none">
                    	<h2>Installing module</h2>
						<img src="img/console-npm-2-2.png" class="console">
                    </section>
                    <section data-transition="none">
                    	<h2>Installing module</h2>
						<img src="img/console-npm-2-3.png" class="console">
                    </section>
                    <section data-transition="none">
                    	<h2>Installing module</h2>
						<img src="img/console-npm-2-4.png" class="console">
                    </section>
                    <section data-transition="none">
                    	<h2>Installing module</h2>
						<img src="img/console-npm-2-5.png" class="console">
                    </section>
                    <section>
                    	<h4>package.json</h4>
						<pre class="no-lines"><code style="max-height: 1280px; font-size: 18pt; line-height: 18pt">{
  "name": "express",
  "version": "3.4.4",
  "dependencies": {
    "connect": "2.11.0", "commander": "1.3.2", "range-parser": "0.0.4", "mkdirp": "0.3.5", "cookie": "0.1.0", "buffer-crc32": "0.2.1", "fresh": "0.2.0", "methods": "0.1.0", "send": "0.1.4", "cookie-signature": "1.0.1", "debug": "*"
  },
  "devDependencies": {
    "ejs": "*", "mocha": "*", "jade": "0.30.0", "hjs": "*", "stylus": "*", "should": "2", "connect-redis": "*", "marked": "*", "supertest": "0.8.1 - 1"
  },
  "main": "index",
  "bin": {
    "express": "./bin/express"
  },
  "scripts": {
    "prepublish": "npm prune",
    "test": "make test"
  },
  "engines": {
    "node": "*"
  }
}
						</code></pre>
                    </section>

                    <section>
						<h2>Express application</h2>

						<pre class="no-lines">
							<code>var express = require('express');
var app = express();
app.get('/', function(req, res) { res.end('Hello!'); });
app.listen(3000);</code>
						</pre>
                    </section>
				</section>

				<section>
					<section>
						<h1>Event loop</h1>
						<img src="img/event-loop-basic.png"/>
					</section>

					<section 
                        data-background="url(img/kantor.png)" 
                        data-background-size="100%"
                        data-transition="linear" 
                        data-background-transition="slide">
                        <h2><a href="http://bit.ly/kantor-node" class="roll">bit.ly/kantor-node</a></h2>
                        <br/><br/><br/><br/>
                    </section>

					<section data-background="img/libuv-github.png"></section>

					<section>
						<h2>node.cc</h2>
						<br/>
						<img src="img/node-cc.png" width="100%"/>
					</section>

					<section>
						<h2>env-inl.h</h2>
						<br/>
						<img src="img/env-inl-h-2.png" width="100%"/>
						<img src="img/env-inl-h-1.png" width="100%" class="fragment"/>
					</section>

					<section>
						<h2>loop.c</h2>
						<br/>
						<img src="img/loop-c-1.png" width="100%"/>
					</section>

					<section>
						<h2>loop.c</h2>
						<br/>
						<pre><code class="cpp">static int uv__loop_init(uv_loop_t* loop, int default_loop) {
	// ...
	RB_INIT(&amp;loop->timer_handles);
	QUEUE_INIT(&amp;loop->wq);
	QUEUE_INIT(&amp;loop->active_reqs);
	QUEUE_INIT(&amp;loop->idle_handles);
	QUEUE_INIT(&amp;loop->async_handles);
	QUEUE_INIT(&amp;loop->check_handles);
	QUEUE_INIT(&amp;loop->prepare_handles);
	QUEUE_INIT(&amp;loop->handle_queue);
	QUEUE_INIT(&amp;loop->pending_queue);
	QUEUE_INIT(&amp;loop->watcher_queue);

	err = uv__platform_loop_init(loop, default_loop);
	// ...
}</code></pre>
					</section>

					<section>
						<h2>Platform init</h2>
						<br/>
						<ul style="font-size: 48pt; line-height: 48pt;">
							<li>kqueue</li>
							<li>epoll</li>
						</ul>
					</section>
					<section>
						<h2>core.c&nbsp;<span style="color: yellow; font-size: 22pt">:&nbsp;258</span></h2>
						<br/>
						<pre><code class="cpp">int uv_run(uv_loop_t* loop, uv_run_mode mode) {
	r = uv__loop_alive(loop);
	while (r != 0 &amp;&amp; loop->stop_flag == 0) {
		// ...
		uv__update_time(loop);
		uv__run_timers(loop);
		uv__io_poll(loop, timeout);
		// ...
	}
}</code></pre>
						<pre><code class="cpp">static int uv__loop_alive(uv_loop_t* loop) {
  return uv__has_active_handles(loop) ||
         uv__has_active_reqs(loop) ||
         loop->closing_handles != NULL;
}</code></pre>
					</section>
					<section>
						<h1>Fibonacci</h1>
						<br/>
						<pre><code>function fibonacci(n) {
  if (n &lt; 2)
    return 1;
  else
    return fibonacci(n-2) + fibonacci(n-1);
}

require('http').createServer(function (req, res) {
  res.end("40: " + fibonacci(40));
}).listen(8005);</code></pre>
					</section>
					<section>
						<h1>Fibonacci</h1>
						<br/>
						<pre class="no-lines"><code style="font-size: 24pt; line-height: 32pt;">Requests per second: 0.61
Time per request: 1634.748 ms (vs 5676 ms)</code></pre>
					</section>
					<section>
						<h1>Fibonacci</h1>
						<br/>
						<pre><code>function fibonacci(i, n, f1, f2, res) {
  if (i >= n)
    res.end(n + ": " + (f1 + f2));
  else
    setImmediate(function() {
        fibonacci(i + 1, n, f2, f1 + f2, res);
    });
}

require('http').createServer(function (req, res) {
  fibonacci(0, 1473, 1, 1, res);
}).listen(8005);</code></pre>
					</section>
					<section>
						<h1>Fibonacci</h1>
						<br/>
						<pre class="no-lines"><code style="font-size: 28pt; line-height: 32pt;">Requests per second: 264.55
Time per request: 3.780 ms</code></pre>
					</section>
				</section>
				
				<section>
					<section>
						<h1>Streams</h1>
					</section>
				</section>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>
		<script src="components/jquery/jquery.min.js"></script>
		<!--[if lte IE 8]><script language="javascript" type="text/javascript" src="excanvas.min.js"></script><![endif]-->
		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				
				transition: Reveal.getQueryHash().transition || 'linear', // default/cube/page/concave/zoom/linear/fade/none

				backgroundTransition: 'slide',
				
				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { 
						hljs.initHighlightingOnLoad();
						linenumbers();
					} },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});
			function linenumbers() {
                $("pre:not(.no-lines) code").each(function(i, precode) {
                    var lines = $(precode).text().split(/\n/g);
                    var content = "";
                    for (var k = 0; k < lines.length; k++){
                        // if($.trim(lines[k]) != "" ){
                            content += "<span class='line'>" + lines[k] + "</span>\n";
                        // }
                    }
                    $(precode).html(content);
                })
            };

		</script>

	</body>
</html>
